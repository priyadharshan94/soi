<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>South India Voice Job Assistant</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f2f2;
  padding: 10px;
}
h2 { text-align: center; }
.card {
  background: white;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 8px;
}
button {
  width: 100%;
  padding: 14px;
  font-size: 18px;
  background: #007bff;
  color: white;
  border: none;
  border-radius: 6px;
}
.lang-btn { background: #28a745; margin-top: 8px; }
.hidden { display: none; }
.job {
  border-top: 1px solid #ddd;
  margin-top: 10px;
  padding-top: 10px;
}
.status {
  font-size: 18px;
  font-weight: bold;
}
</style>
</head>

<body>

<h2>üé§ South India Voice Job Assistant</h2>

<!-- START SCREEN -->
<div class="card" id="startScreen">
  <button onclick="startBot()">üé§ Start Voice Assistant</button>
</div>

<!-- LANGUAGE SCREEN -->
<div class="card hidden" id="langScreen">
  <h3>Select Language</h3>
  <button class="lang-btn" onclick="selectLanguage('ta-IN')">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
  <button class="lang-btn" onclick="selectLanguage('te-IN')">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</button>
  <button class="lang-btn" onclick="selectLanguage('kn-IN')">‡≤ï‡≤®‡≥ç‡≤®‡≤°</button>
  <button class="lang-btn" onclick="selectLanguage('ml-IN')">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
</div>

<!-- STATUS -->
<div class="card status hidden" id="statusBox">Status</div>

<!-- JOB RESULTS -->
<div id="jobs"></div>

<script>
// ================= SAMPLE JOB DATA =================
if (!localStorage.jobs) {
  localStorage.jobs = JSON.stringify([
    { title: "Plumber Needed", skill: "plumber", location: "chennai", salary: "‚Çπ800/day" },
    { title: "Electrician Needed", skill: "electrician", location: "madurai", salary: "‚Çπ900/day" },
    { title: "Cleaner Needed", skill: "cleaner", location: "kochi", salary: "‚Çπ600/day" },
    { title: "Electrician Needed", skill: "electrician", location: "bengaluru", salary: "‚Çπ1000/day" }
  ]);
}

// ================= GLOBAL STATE =================
let language = "en-IN";
let step = 0;
let userSkill = "";
let userLocation = "";
let voices = [];

// ================= LOAD VOICES =================
speechSynthesis.onvoiceschanged = () => {
  voices = speechSynthesis.getVoices();
};
voices = speechSynthesis.getVoices();

// ================= SPEAK SAFELY =================
function speak(text) {
  if (!text) return;
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  u.lang = language;
  const v = voices.find(v => v.lang === language);
  if (v) u.voice = v;
  speechSynthesis.speak(u);
}

// ================= START BOT =================
function startBot() {
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("langScreen").classList.remove("hidden");
  document.getElementById("statusBox").classList.remove("hidden");
  updateStatus("Choose your language");
  speak("Please select your language");
}

// ================= SELECT LANGUAGE =================
function selectLanguage(lang) {
  language = lang;
  document.getElementById("langScreen").classList.add("hidden");

  const greet = {
    "ta-IN": "‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç. ‡Æ®‡Ææ‡Æ©‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Øá‡Æ≤‡Øà ‡Æ§‡Øá‡Æü ‡Æâ‡Æ§‡Æµ‡ØÅ‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç.",
    "te-IN": "‡∞®‡∞Æ‡∞∏‡±ç‡∞ï‡∞æ‡∞∞‡∞Ç. ‡∞®‡±á‡∞®‡±Å ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞â‡∞¶‡±ç‡∞Ø‡±ã‡∞ó‡∞Ç ‡∞ï‡∞®‡±Å‡∞ó‡±ä‡∞®‡∞°‡∞Ç‡∞≤‡±ã ‡∞∏‡∞π‡∞æ‡∞Ø‡∞™‡∞°‡∞§‡∞æ‡∞®‡±Å.",
    "kn-IN": "‡≤®‡≤Æ‡≤∏‡≥ç‡≤ï‡≤æ‡≤∞. ‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤ø‡≤Æ‡≤ó‡≥Ü ‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤π‡≥Å‡≤°‡≥Å‡≤ï‡≤≤‡≥Å ‡≤∏‡≤π‡≤æ‡≤Ø ‡≤Æ‡≤æ‡≤°‡≥Å‡≤§‡≥ç‡≤§‡≥á‡≤®‡≥Ü.",
    "ml-IN": "‡¥®‡¥Æ‡¥∏‡µç‡¥ï‡¥æ‡¥∞‡¥Ç. ‡¥û‡¥æ‡µª ‡¥ú‡µã‡¥≤‡¥ø ‡¥ï‡¥£‡µç‡¥ü‡µÜ‡¥§‡µç‡¥§‡¥æ‡µª ‡¥∏‡¥π‡¥æ‡¥Ø‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥Ç."
  };
  speak(greet[language]);

  step = 1;
  setTimeout(askNext, 2500);
}

// ================= STATUS UPDATE =================
function updateStatus(text) {
  document.getElementById("statusBox").innerText = text;
}

// ================= CREATE RECOGNITION =================
function createRecognition() {
  const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  const rec = new SR();
  rec.lang = language;
  rec.interimResults = false;
  return rec;
}

// ================= BOT FLOW =================
function askNext() {
  let question = "";

  if (step === 1) {
    updateStatus("üéß Listening for skill...");
    question = {
      "ta-IN": "‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Øá‡Æ≤‡Øà ‡Æ§‡Æø‡Æ±‡Æ©‡Øç ‡Æé‡Æ©‡Øç‡Æ©?",
      "te-IN": "‡∞Æ‡±Ä ‡∞®‡±à‡∞™‡±Å‡∞£‡±ç‡∞Ø‡∞Ç ‡∞è‡∞Æ‡∞ø‡∞ü‡∞ø?",
      "kn-IN": "‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤ï‡≥å‡≤∂‡≤≤‡≥ç‡≤Ø ‡≤è‡≤®‡≥Å?",
      "ml-IN": "‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ï‡¥¥‡¥ø‡¥µ‡µç ‡¥é‡¥®‡µç‡¥§‡¥æ‡¥£‡µç?"
    }[language];
  }

  if (step === 2) {
    updateStatus("üéß Listening for location...");
    question = {
      "ta-IN": "‡Æé‡Æ®‡Øç‡Æ§ ‡Æá‡Æü‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æµ‡Øá‡Æ≤‡Øà ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç?",
      "te-IN": "‡∞è ‡∞™‡±ç‡∞∞‡∞æ‡∞Ç‡∞§‡∞Ç‡∞≤‡±ã ‡∞™‡∞®‡∞ø ‡∞ï‡∞æ‡∞µ‡∞æ‡∞≤‡∞ø?",
      "kn-IN": "‡≤Ø‡≤æ‡≤µ ‡≤∏‡≥ç‡≤•‡≤≥‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø ‡≤ï‡≥Ü‡≤≤‡≤∏ ‡≤¨‡≥á‡≤ï‡≥Å?",
      "ml-IN": "‡¥è‡¥§‡µç ‡¥∏‡µç‡¥•‡¥≤‡¥§‡µç‡¥§‡µç ‡¥ú‡µã‡¥≤‡¥ø ‡¥µ‡µá‡¥£‡¥Ç?"
    }[language];
  }

  speak(question);

  const rec = createRecognition();
  rec.start();

  rec.onresult = e => {
    const answer = e.results[0][0].transcript.toLowerCase();

    if (step === 1) {
      userSkill = answer;
      step = 2;
      setTimeout(askNext, 2000);
    } else if (step === 2) {
      userLocation = answer;
      step = 3;
      setTimeout(searchJobs, 2000);
    }
  };
}

// ================= SEARCH JOBS =================
function searchJobs() {
  updateStatus("üîç Searching jobs...");

  const jobs = JSON.parse(localStorage.jobs);
  const results = jobs.filter(j =>
    j.skill.includes(userSkill) &&
    j.location.includes(userLocation)
  );

  const container = document.getElementById("jobs");
  container.innerHTML = "";

  if (results.length === 0) {
    speak({
      "ta-IN": "‡Æµ‡Øá‡Æ≤‡Øà ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà",
      "te-IN": "‡∞â‡∞¶‡±ç‡∞Ø‡±ã‡∞ó‡∞æ‡∞≤‡±Å ‡∞≤‡∞≠‡∞ø‡∞Ç‡∞ö‡∞≤‡±á‡∞¶‡±Å",
      "kn-IN": "‡≤ï‡≥Ü‡≤≤‡≤∏‡≤ó‡≤≥‡≥Å ‡≤∏‡≤ø‡≤ó‡≤≤‡≤ø‡≤≤‡≥ç‡≤≤",
      "ml-IN": "‡¥ú‡µã‡¥≤‡¥ø‡¥ï‡µæ ‡¥≤‡¥≠‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤"
    }[language]);
    updateStatus("‚ùå No jobs found");
    return;
  }

  speak(results.length + " jobs found");
  updateStatus("‚úÖ Jobs found");

  results.forEach(job => {
    speak(job.title + " " + job.location + " " + job.salary);
    container.innerHTML += `
      <div class="card job">
        <h4>${job.title}</h4>
        <p>${job.location}</p>
        <p>${job.salary}</p>
        <button onclick="applyJob()">Apply</button>
      </div>
    `;
  });
}

// ================= APPLY =================
function applyJob() {
  speak({
    "ta-IN": "‡Æµ‡Æø‡Æ£‡Øç‡Æ£‡Æ™‡Øç‡Æ™‡ÆÆ‡Øç ‡Æµ‡ØÜ‡Æ±‡Øç‡Æ±‡Æø‡Æï‡Æ∞‡ÆÆ‡Ææ‡Æï ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Øç‡Æ™‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü‡Æ§‡ØÅ",
    "te-IN": "‡∞¶‡∞∞‡∞ñ‡∞æ‡∞∏‡±ç‡∞§‡±Å ‡∞µ‡∞ø‡∞ú‡∞Ø‡∞µ‡∞Ç‡∞§‡∞Æ‡±à‡∞Ç‡∞¶‡∞ø",
    "kn-IN": "‡≤Ö‡≤∞‡≥ç‡≤ú‡≤ø‡≤Ø‡≤®‡≥ç‡≤®‡≥Å ‡≤Ø‡≤∂‡≤∏‡≥ç‡≤µ‡≤ø‡≤Ø‡≤æ‡≤ó‡≤ø ‡≤∏‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü",
    "ml-IN": "‡¥Ö‡¥™‡µá‡¥ï‡µç‡¥∑ ‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ï‡¥∞‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥∏‡¥Æ‡µº‡¥™‡µç‡¥™‡¥ø‡¥ö‡µç‡¥ö‡µÅ"
  }[language]);
  updateStatus("üì® Applied successfully");
  alert("Applied Successfully");
}
</script>

</body>
</html>
